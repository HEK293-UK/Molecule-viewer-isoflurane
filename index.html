<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3Dmol Ball-and-Stick Custom Viewer</title>
  <script src="https://3dmol.org/build/3Dmol-min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }
    #viewer {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="viewer"></div>
  <script>
    const elementColours = {
  C: "#363636",
  O: "#FF3838",
  N: "#7070FF",
  H: "#FFFFFF",
  S: "goldenrod",
  F: "#00CC99",
  Cl: "#66CC00"
    };

    const viewer = $3Dmol.createViewer("viewer", {
      backgroundColor: "white"
    });

    $3Dmol.download("cid:4369440", viewer, {noAutoStyle: true}, function(data) {
      const model = viewer.addModel(data, "sdf");

      // Set style: ball-and-stick with colour function
      model.setStyle({}, {
        sphere: {
          radius: 0.3,
          colorfunc: atom => elementColours[atom.elem] || "teal"
        },
        stick: {
          radius: 0.15,
          colorfunc: atom => elementColours[atom.elem] || "teal"
        }
      });

      viewer.zoomTo();
      viewer.render();

      // Add labels for non-hydrogens
      const atoms = model.selectedAtoms({});
      for (const atom of atoms) {
        if (atom.elem !== "H" && atom.x != null) {
          viewer.addLabel(atom.elem, {
            position: atom,
            backgroundColor: "white",
            backgroundOpacity: 0.7,
            fontColor: "black",
            fontSize: 12,
            showBackground: true,
            inFront: false
          });
        }
      }

      viewer.render();
    });
  </script>
</body>
</html>
